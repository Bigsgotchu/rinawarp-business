<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RinaWarp Terminal Pro - Downloads</title>
    <script src="https://js.stripe.com/v3/"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
        color: #00ff00;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        text-align: center;
        margin-bottom: 40px;
        padding: 40px 0;
        background: rgba(255, 105, 180, 0.1);
        border-radius: 20px;
        border: 2px solid #ff69b4;
      }

      .logo {
        font-size: 48px;
        margin-bottom: 20px;
      }

      .title {
        font-size: 36px;
        color: #ff69b4;
        margin-bottom: 10px;
      }

      .subtitle {
        font-size: 18px;
        color: #40e0d0;
        margin-bottom: 30px;
      }

      .pricing-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        margin-bottom: 40px;
      }

      .pricing-card {
        background: rgba(0, 0, 0, 0.8);
        border: 2px solid #00ff00;
        border-radius: 15px;
        padding: 30px;
        text-align: center;
        transition: all 0.3s ease;
        position: relative;
      }

      .pricing-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 255, 0, 0.3);
      }

      .pricing-card.featured {
        border-color: #ff69b4;
        background: rgba(255, 105, 180, 0.1);
      }

      .pricing-card.featured::before {
        content: 'POPULAR';
        position: absolute;
        top: -10px;
        left: 50%;
        transform: translateX(-50%);
        background: #ff69b4;
        color: white;
        padding: 5px 20px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: bold;
      }

      .plan-name {
        font-size: 24px;
        color: #ff69b4;
        margin-bottom: 10px;
      }

      .plan-price {
        font-size: 36px;
        color: #00ff00;
        margin-bottom: 20px;
      }

      .plan-features {
        list-style: none;
        margin-bottom: 30px;
      }

      .plan-features li {
        padding: 8px 0;
        color: #40e0d0;
      }

      .plan-features li::before {
        content: '‚úÖ ';
        margin-right: 10px;
      }

      .download-btn {
        background: linear-gradient(45deg, #ff69b4, #40e0d0);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 25px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
        margin-bottom: 10px;
      }

      .download-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4);
      }

      .download-btn:disabled {
        background: #666;
        cursor: not-allowed;
        transform: none;
      }

      .platform-info {
        background: rgba(0, 0, 0, 0.6);
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 30px;
      }

      .platform-info h3 {
        color: #ff69b4;
        margin-bottom: 15px;
      }

      .platform-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
      }

      .platform-item {
        background: rgba(0, 255, 0, 0.1);
        border: 1px solid #00ff00;
        border-radius: 8px;
        padding: 15px;
        text-align: center;
      }

      .platform-icon {
        font-size: 24px;
        margin-bottom: 10px;
      }

      .status-indicator {
        display: inline-block;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        margin-right: 8px;
      }

      .status-online {
        background: #00ff00;
        animation: pulse 2s infinite;
      }

      .status-offline {
        background: #ff4444;
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }

      .loading {
        display: none;
        text-align: center;
        margin: 20px 0;
      }

      .spinner {
        border: 3px solid #333;
        border-top: 3px solid #00ff00;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
        margin: 0 auto 10px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .error-message {
        background: rgba(255, 68, 68, 0.2);
        border: 1px solid #ff4444;
        color: #ff4444;
        padding: 15px;
        border-radius: 8px;
        margin: 20px 0;
        display: none;
      }

      .success-message {
        background: rgba(0, 255, 0, 0.2);
        border: 1px solid #00ff00;
        color: #00ff00;
        padding: 15px;
        border-radius: 8px;
        margin: 20px 0;
        display: none;
      }

      .footer {
        text-align: center;
        margin-top: 40px;
        padding: 20px;
        border-top: 1px solid #333;
        color: #666;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="logo">üßú‚Äç‚ôÄÔ∏è</div>
        <h1 class="title">RinaWarp Terminal Pro</h1>
        <p class="subtitle">AI-Powered Terminal with Voice & Auto-Updates</p>
        <div class="status-indicator status-online"></div>
        <span>Production Ready</span>
      </div>

      <div class="pricing-grid">
        <!-- Free Plan -->
        <div class="pricing-card">
          <h3 class="plan-name">Free</h3>
          <div class="plan-price">$0</div>
          <ul class="plan-features">
            <li>Basic AI capabilities</li>
            <li>Limited voice synthesis</li>
            <li>Basic themes</li>
            <li>Community support</li>
            <li>System monitoring</li>
            <li>Always free</li>
          </ul>
          <button class="download-btn" onclick="downloadFree()">Download Free</button>
          <p style="font-size: 12px; color: #666; margin-top: 10px">No credit card required</p>
        </div>

        <!-- Professional Plan -->
        <div class="pricing-card featured">
          <h3 class="plan-name">Professional</h3>
          <div class="plan-price">$29.99</div>
          <div style="font-size: 14px; color: #40e0d0; margin-bottom: 20px">per month</div>
          <ul class="plan-features">
            <li>Dual AI providers (OpenAI + Groq)</li>
            <li>Custom voice synthesis</li>
            <li>Premium themes</li>
            <li>Auto-updates</li>
            <li>Priority support</li>
            <li>Commercial license</li>
            <li>Advanced features</li>
          </ul>
          <button class="download-btn" onclick="purchasePlan('professional')">
            Subscribe Monthly
          </button>
          <p style="font-size: 12px; color: #ff69b4; margin-top: 10px">Most Popular</p>
        </div>

        <!-- Business Plan -->
        <div class="pricing-card">
          <h3 class="plan-name">Business</h3>
          <div class="plan-price">$49.99</div>
          <div style="font-size: 14px; color: #40e0d0; margin-bottom: 20px">per month</div>
          <ul class="plan-features">
            <li>Everything in Professional</li>
            <li>Team collaboration</li>
            <li>Advanced analytics</li>
            <li>Custom integrations</li>
            <li>24/7 support</li>
            <li>Volume licensing</li>
            <li>Admin dashboard</li>
          </ul>
          <button class="download-btn" onclick="purchasePlan('business')">Subscribe Monthly</button>
        </div>

        <!-- Lifetime Plan -->
        <div class="pricing-card">
          <h3 class="plan-name">Lifetime Access</h3>
          <div class="plan-price">$299.99</div>
          <div style="font-size: 14px; color: #40e0d0; margin-bottom: 20px">one-time</div>
          <ul class="plan-features">
            <li>Everything in Professional</li>
            <li>Lifetime updates</li>
            <li>Future features included</li>
            <li>Priority support</li>
            <li>Commercial license</li>
            <li>No recurring fees</li>
          </ul>
          <button class="download-btn" onclick="purchasePlan('lifetime')">Buy Lifetime</button>
          <p style="font-size: 12px; color: #ff69b4; margin-top: 10px">
            First 500 people only! <span id="lifetimeRemaining">(347 remaining)</span>
          </p>
        </div>
      </div>

      <div class="platform-info">
        <h3>üñ•Ô∏è Supported Platforms</h3>
        <div class="platform-list">
          <div class="platform-item">
            <div class="platform-icon">ü™ü</div>
            <div>Windows 10/11</div>
            <div style="font-size: 12px; color: #666">.exe installer</div>
          </div>
          <div class="platform-item">
            <div class="platform-icon">üçé</div>
            <div>macOS 10.15+</div>
            <div style="font-size: 12px; color: #666">.dmg installer</div>
          </div>
          <div class="platform-item">
            <div class="platform-icon">üêß</div>
            <div>Linux (Ubuntu/Debian)</div>
            <div style="font-size: 12px; color: #00ff00">‚úÖ Available (.deb)</div>
          </div>
          <div class="platform-item">
            <div class="platform-icon">üì±</div>
            <div>Linux (AppImage)</div>
            <div style="font-size: 12px; color: #00ff00">‚úÖ Available (.AppImage)</div>
          </div>
        </div>
      </div>

      <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Processing your request...</p>
      </div>

      <div class="error-message" id="errorMessage"></div>
      <div class="success-message" id="successMessage"></div>

      <!-- Feedback Form Modal -->
      <div
        id="feedbackModal"
        style="
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.8);
          z-index: 1000;
        "
      >
        <div
          style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ff00;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
          "
        >
          <h3 style="color: #ff69b4; margin-bottom: 20px; text-align: center">üí¨ Send Feedback</h3>
          <form id="feedbackForm">
            <div style="margin-bottom: 15px">
              <label style="color: #40e0d0; display: block; margin-bottom: 5px">Your Email:</label>
              <input
                type="email"
                id="feedbackEmail"
                required
                style="
                  width: 100%;
                  padding: 10px;
                  background: rgba(0, 255, 0, 0.1);
                  border: 1px solid #00ff00;
                  border-radius: 5px;
                  color: #00ff00;
                "
              />
            </div>
            <div style="margin-bottom: 15px">
              <label style="color: #40e0d0; display: block; margin-bottom: 5px">Subject:</label>
              <input
                type="text"
                id="feedbackSubject"
                required
                style="
                  width: 100%;
                  padding: 10px;
                  background: rgba(0, 255, 0, 0.1);
                  border: 1px solid #00ff00;
                  border-radius: 5px;
                  color: #00ff00;
                "
              />
            </div>
            <div style="margin-bottom: 15px">
              <label style="color: #40e0d0; display: block; margin-bottom: 5px">Message:</label>
              <textarea
                id="feedbackMessage"
                required
                rows="4"
                style="
                  width: 100%;
                  padding: 10px;
                  background: rgba(0, 255, 0, 0.1);
                  border: 1px solid #00ff00;
                  border-radius: 5px;
                  color: #00ff00;
                  resize: vertical;
                "
              ></textarea>
            </div>
            <div style="text-align: center">
              <button
                type="submit"
                style="
                  background: linear-gradient(45deg, #ff69b4, #40e0d0);
                  color: white;
                  border: none;
                  padding: 12px 30px;
                  border-radius: 25px;
                  font-weight: bold;
                  cursor: pointer;
                  margin-right: 10px;
                "
              >
                Send Feedback
              </button>
              <button
                type="button"
                onclick="hideFeedbackForm()"
                style="
                  background: #666;
                  color: white;
                  border: none;
                  padding: 12px 30px;
                  border-radius: 25px;
                  cursor: pointer;
                "
              >
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>

      <div class="footer">
        <p>&copy; 2025 RinaWarp Technologies, LLC. All rights reserved.</p>
        <p>Secure payments powered by Stripe | Auto-updates via AWS S3</p>
        <p>
          <a href="/privacy.html" style="color: #40e0d0; text-decoration: none; margin: 0 10px"
            >Privacy Policy</a
          >
          |
          <a href="/terms.html" style="color: #40e0d0; text-decoration: none; margin: 0 10px"
            >Terms of Service</a
          >
          |
          <a
            href="#feedback"
            onclick="showFeedbackForm()"
            style="color: #40e0d0; text-decoration: none; margin: 0 10px"
            >Feedback</a
          >
        </p>
      </div>
    </div>

    <script>
      // Stripe configuration
      const stripe = Stripe('pk_live_51234567890abcdef'); // Replace with your publishable key

      // Pricing configuration
      const pricing = {
        free: {
          name: 'Free - Always Free',
        },
        professional: {
          priceId: 'price_professional_2999',
          name: 'Professional - $29.99/month',
        },
        business: {
          priceId: 'price_business_4999',
          name: 'Business - $49.99/month',
        },
        lifetime: {
          priceId: 'price_lifetime_29999',
          name: 'Lifetime Access - $299.99',
        },
      };

      // Show loading state
      function showLoading() {
        document.getElementById('loading').style.display = 'block';
        document.querySelectorAll('.download-btn').forEach((btn) => {
          btn.disabled = true;
        });
      }

      // Hide loading state
      function hideLoading() {
        document.getElementById('loading').style.display = 'none';
        document.querySelectorAll('.download-btn').forEach((btn) => {
          btn.disabled = false;
        });
      }

      // Show error message
      function showError(message) {
        const errorDiv = document.getElementById('errorMessage');
        errorDiv.textContent = message;
        errorDiv.style.display = 'block';
        setTimeout(() => {
          errorDiv.style.display = 'none';
        }, 5000);
      }

      // Show success message
      function showSuccess(message) {
        const successDiv = document.getElementById('successMessage');
        successDiv.textContent = message;
        successDiv.style.display = 'block';
        setTimeout(() => {
          successDiv.style.display = 'none';
        }, 5000);
      }

      // Download free version
      function downloadFree() {
        showLoading();

        try {
          // Direct download from releases
          window.location.href = '/releases/1.0.0/RinaWarp%20Terminal%20Pro-1.0.0.AppImage';
          showSuccess('Free version download started! Check your downloads folder.');
        } catch (error) {
          console.error('Free download error:', error);
          showError('Failed to start download. Please try again.');
        } finally {
          hideLoading();
        }
      }

      // Purchase plan
      async function purchasePlan(planType) {
        showLoading();

        try {
          const plan = pricing[planType];
          if (!plan) {
            throw new Error('Invalid plan type');
          }

          // Create checkout session
          const response = await fetch('/api/stripe/create-checkout-session', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              priceId: plan.priceId,
              success_url: window.location.origin + '/downloads?purchase=success',
              cancel_url: window.location.origin + '/downloads?purchase=cancelled',
            }),
          });

          const data = await response.json();

          if (data.url) {
            // Redirect to Stripe Checkout
            window.location.href = data.url;
          } else {
            throw new Error(data.error || 'Failed to create checkout session');
          }
        } catch (error) {
          console.error('Purchase error:', error);
          showError('Failed to process payment. Please try again.');
        } finally {
          hideLoading();
        }
      }

      // Handle URL parameters for success/cancel
      window.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);

        if (urlParams.get('purchase') === 'success') {
          showSuccess('Payment successful! Check your email for download instructions.');
        } else if (urlParams.get('purchase') === 'cancelled') {
          showError('Payment was cancelled.');
        }
      });

      // Check backend status
      async function checkBackendStatus() {
        try {
          const response = await fetch('/api/stripe/health');
          const data = await response.json();

          if (data.status === 'healthy') {
            console.log('Backend is healthy');
          } else {
            showError('Backend is not responding. Please try again later.');
          }
        } catch (error) {
          console.error('Backend check failed:', error);
          showError('Unable to connect to server. Please check your internet connection.');
        }
      }

      // Check backend status on load
      checkBackendStatus();

      // Update lifetime counter
      updateLifetimeCounter();

      // Update lifetime counter
      async function updateLifetimeCounter() {
        try {
          const response = await fetch('/api/stripe/lifetime-count');
          const data = await response.json();

          const remaining = Math.max(0, 500 - data.sold);
          document.getElementById('lifetimeRemaining').textContent = `(${remaining} remaining)`;

          // Add urgency styling if low
          if (remaining < 50) {
            document.getElementById('lifetimeRemaining').style.color = '#ff4444';
            document.getElementById('lifetimeRemaining').style.fontWeight = 'bold';
          }
        } catch (error) {
          console.error('Failed to update lifetime counter:', error);
          // Keep default value if API fails
        }
      }

      // Show feedback form
      function showFeedbackForm() {
        document.getElementById('feedbackModal').style.display = 'block';
      }

      // Hide feedback form
      function hideFeedbackForm() {
        document.getElementById('feedbackModal').style.display = 'none';
        document.getElementById('feedbackForm').reset();
      }

      // Handle feedback form submission
      document.getElementById('feedbackForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const email = document.getElementById('feedbackEmail').value;
        const subject = document.getElementById('feedbackSubject').value;
        const message = document.getElementById('feedbackMessage').value;

        try {
          const response = await fetch('/api/feedback', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              email,
              subject,
              message,
              url: window.location.href,
            }),
          });

          if (response.ok) {
            showSuccess('Thank you for your feedback! We appreciate your input.');
            hideFeedbackForm();
          } else {
            showError('Failed to send feedback. Please try again.');
          }
        } catch (error) {
          console.error('Feedback submission error:', error);
          showError('Failed to send feedback. Please try again.');
        }
      });
    </script>
  </body>
</html>
