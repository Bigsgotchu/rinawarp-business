# RinaWarp Terminal Pro - Production Deployment Guide

## ðŸš€ Quick Deployment

### Prerequisites

- Ubuntu/Debian server with root access
- Domain name pointing to your server (e.g., `rinawarptech.com`)
- Stripe account with API keys


### Automated Deployment (One Command)

```bash
# Navigate to the project directory
cd /home/karina/Documents/Rinawarp-Platforms/src/domain/terminal

# Run the complete automated deployment
sudo ./deploy-production.sh
```

This script will automatically:

- âœ… Install all required packages (Nginx, PM2, Certbot)
- âœ… Configure the backend server with PM2
- âœ… Set up Nginx reverse proxy with SSL
- âœ… Generate and install SSL certificates
- âœ… Update frontend API URLs
- âœ… Test the deployment
- âœ… Provide management commands


### Manual Deployment (Advanced Users)

### 1. Environment Setup

1. **Configure Environment Variables**


   ```bash
   cd src/domain/terminal
   # Edit .env file with your actual API keys
   nano .env

   ```

   **Required Variables:**

   ```env
   NODE_ENV=production
   PORT=3001
   DOMAIN=yourdomain.com

   # Stripe Configuration (REQUIRED)
   STRIPE_SECRET_KEY=sk_live_your_actual_secret_key
   STRIPE_PUBLISHABLE_KEY=pk_live_your_actual_publishable_key
   STRIPE_WEBHOOK_SECRET=whsec_your_actual_webhook_secret

   # Optional AI Provider Keys
   OPENAI_API_KEY=your_openai_api_key
   GROQ_API_KEY=your_groq_api_key

   ```

2. **Update Frontend API URL**

   Edit `public/music-video/index.html` and update:

   ```javascript
   window.__API_URL__ =
     'https://api.yourdomain.com/api/create-checkout-session';
   ```

### 2. Deploy Backend Server

**Option A: Complete Automated Deployment (Recommended)**

```bash
# Navigate to terminal directory
cd src/domain/terminal


# Run the complete production deployment script
sudo ./deploy-production.sh
```

**Option B: Manual Deployment**

```bash
# Navigate to terminal directory
cd src/domain/terminal

# Run basic deployment script
./deploy.sh

# Or manually with PM2
pm2 start ecosystem.config.cjs --only rinawarp-backend-server
pm2 save
```

### 3. Configure Stripe Webhooks

1. **In Stripe Dashboard:**
   - Go to Developers â†’ Webhooks
   - Add endpoint: `https://api.yourdomain.com/api/webhook`
   - Select events: `checkout.session.completed`, `customer.subscription.created`, etc.

2. **Update Webhook Secret:**
   - Copy the webhook secret from Stripe

   - Update `STRIPE_WEBHOOK_SECRET` in `.env`


### 4. Domain Configuration

**Option A: Nginx Reverse Proxy (Recommended)**

1. **Install Nginx:**


   ```bash
   sudo apt update
   sudo apt install nginx
   ```

2. **Create Nginx Configuration:**


   ```bash
   # Copy the configuration file
   sudo cp src/domain/terminal/rinawarptech.conf /etc/nginx/sites-available/rinawarptech

   # Enable the site
   sudo ln -s /etc/nginx/sites-available/rinawarptech /etc/nginx/sites-enabled/


   # Test configuration
   sudo nginx -t

   # Restart Nginx
   sudo systemctl restart nginx
   ```

3. **Install SSL with Certbot:**


   ```bash
   # Install Certbot
   sudo apt install certbot python3-certbot-nginx


   # Get SSL certificate
   sudo certbot --nginx -d rinawarptech.com -d www.rinawarptech.com


   # Enable auto-renewal
   sudo systemctl enable certbot.timer
   sudo systemctl start certbot.timer
   ```

**Option B: Direct Domain**

- Point your domain's A record to your server IP
- Update `DOMAIN` in `.env` to your actual domain


**Option B: Direct Domain**

- Point your domain's A record to your server IP
- Update `DOMAIN` in `.env` to your actual domain


### 5. SSL Certificate (Required for Production)

```bash
# Install certbot
sudo apt install certbot

# Get SSL certificate

sudo certbot --nginx -d api.yourdomain.com

# Or with PM2 ecosystem (add to ecosystem.config.cjs)
env: {
  NODE_ENV: 'production',
  HTTPS: 'true'

}
```

## ðŸ“Š Monitoring & Management

### View Logs

```bash
pm2 logs rinawarp-backend-server
pm2 logs rinawarp-backend-server --lines 100
```

### Server Management

```bash

# Status
pm2 status

# Restart
pm2 restart rinawarp-backend-server

# Stop
pm2 stop rinawarp-backend-server

# Monitor
pm2 monit
```

### Health Check

```bash
curl http://localhost:3001/health
```

## ðŸ”§ Troubleshooting

### Common Issues

1. **404 Errors on API endpoints**
   - Check if server is running: `pm2 status`

   - Verify port 3001 is accessible
   - Check firewall settings

2. **Stripe Integration Issues**
   - Verify API keys in `.env`
   - Check Stripe webhook configuration

   - Test with Stripe CLI: `stripe listen --forward-to localhost:3001/api/webhook`

3. **CORS Issues**
   - Update CORS origins in `server.js`
   - Check domain configuration


### Testing Subscription Flow

1. **Start server locally:**


   ```bash
   cd src/domain/terminal
   node server.js
   ```

2. **Test API endpoints:**


   ```bash
   curl http://localhost:3001/health
   curl -X POST http://localhost:3001/api/create-checkout-session \
     -H "Content-Type: application/json" \
     -d '{"plan": "music_creator_monthly", "email": "test@example.com"}'
   ```

3. **Test frontend:**
   - Open `http://localhost:3001/music-video`
   - Try purchasing a subscription
   - Check browser console for errors


## ðŸ“‹ Production Checklist

- [ ] Environment variables configured
- [ ] Stripe API keys set
- [ ] Webhook endpoint configured
- [ ] SSL certificate installed
- [ ] Domain pointing to server

- [ ] PM2 auto-restart configured
- [ ] Frontend API URL updated
- [ ] Health check endpoint working
- [ ] Subscription flow tested


## ðŸš¨ Security Notes

- Never commit `.env` files to version control
- Use strong, unique passwords for all API keys
- Enable HTTPS in production
- Regularly rotate API keys
- Monitor server logs for suspicious activity
- Keep Node.js and dependencies updated


## ðŸ“ž Support

If you encounter issues:

1. Check PM2 logs: `pm2 logs`
2. Verify environment variables
3. Test API endpoints directly
4. Check Stripe dashboard for errors
