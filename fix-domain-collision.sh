#!/bin/bash

# üö® CLOUDFLARE DOMAIN COLLISION FIX SCRIPT
# This script provides the complete steps to fix the domain collision issue

echo "üö® CLOUDFLARE DOMAIN COLLISION FIX - COMPLETE WORKFLOW"
echo "======================================================"
echo ""
echo "PROBLEM IDENTIFIED:"
echo "- rinawarp-stripe-worker has rinawarptech.com attached (WRONG)"
echo "- rinawarptech project has NO domain attached (CORRECT PROJECT)"
echo ""
echo "üéØ SOLUTION: Move domain from Stripe Worker to Website Project"
echo ""
echo "COMPLETE STEPS TO FOLLOW:"
echo ""
echo "1Ô∏è‚É£  REMOVE DOMAIN FROM STRIPE WORKER (CRITICAL - DO THIS FIRST):"
echo "   ‚Ä¢ Go to: https://dash.cloudflare.com/pages"
echo "   ‚Ä¢ Click: 'rinawarp-stripe-worker' project"
echo "   ‚Ä¢ Go to: 'Custom domains' tab"
echo "   ‚Ä¢ Click: 'rinawarptech.com'"
echo "   ‚Ä¢ Click: 'Remove domain'"
echo "   ‚Ä¢ Confirm removal"
echo ""
echo "2Ô∏è‚É£  ATTACH DOMAIN TO WEBSITE PROJECT:"
echo "   ‚Ä¢ Click: 'rinawarptech' project (the website)"
echo "   ‚Ä¢ Go to: 'Custom domains' tab"
echo "   ‚Ä¢ Click: 'Set up a custom domain'"
echo "   ‚Ä¢ Enter: 'rinawarptech.com'"
echo "   ‚Ä¢ Click: 'Continue'"
echo ""
echo "3Ô∏è‚É£  DNS SETUP (What you're seeing now):"
echo "   ‚Ä¢ Cloudflare will show CNAME setup screen"
echo "   ‚Ä¢ Log into your DNS provider (where you bought rinawarptech.com)"
echo "   ‚Ä¢ Add CNAME record:"
echo "     Name: rinawarptech.com (or @)"
echo "     Target: rinawarptech.pages.dev"
echo "   ‚Ä¢ Save changes"
echo "   ‚Ä¢ Return to Cloudflare and click 'Check DNS records'"
echo ""
echo "4Ô∏è‚É£  CLEAR CACHES:"
echo "   ‚Ä¢ Go to: https://dash.cloudflare.com/caching"
echo "   ‚Ä¢ Click: 'Configuration' tab"
echo "   ‚Ä¢ Click: 'Purge Everything'"
echo "   ‚Ä¢ Confirm purge"
echo ""
echo "5Ô∏è‚É£  WAIT FOR DNS PROPAGATION:"
echo "   ‚Ä¢ DNS changes take 5 minutes to 24 hours globally"
echo "   ‚Ä¢ Test with: nslookup rinawarptech.com"
echo "   ‚Ä¢ Visit: https://rinawarptech.com"
echo ""
echo "‚úÖ VERIFICATION (after DNS propagation):"
echo "   ‚Ä¢ Website shows your actual content (not Stripe Worker code)"
echo "   ‚Ä¢ New deployments appear immediately"
echo "   ‚Ä¢ _headers file is served correctly"
echo "   ‚Ä¢ Stripe Worker still works on /api/* routes"
echo ""
echo "üîß THIS FIXES:"
echo "   ‚Ä¢ Changes not appearing"
echo "   ‚Ä¢ Cache headers not updating"
echo "   ‚Ä¢ Old designs reappearing"
echo "   ‚Ä¢ _headers file not being served"
echo "   ‚Ä¢ Deployment caching issues"
echo ""
echo "‚ö†Ô∏è  CRITICAL NOTES:"
echo "   ‚Ä¢ Step 1 MUST be completed before Step 2"
echo "   ‚Ä¢ Don't delete rinawarp-stripe-worker, just remove main domain"
echo "   ‚Ä¢ DNS propagation time varies by provider"
echo "   ‚Ä¢ Keep Stripe Worker for API routes only"